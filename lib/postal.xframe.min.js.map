{"version":3,"sources":["postal.xframe.js"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_1__","__WEBPACK_EXTERNAL_MODULE_2__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","listener","plugin","routeMessage","apply","arguments","listenToWorker","worker","_lodash2","include","_state","state","workers","addEventListener","push","_lodash","_postal","_postal2","_utils","_XFrameClient","_XFrameClient2","getInstance","source","origin","instanceId","client","isWorker","Worker","options","target","NO_OP","fedx","transports","xframe","eagerSerialize","env","useEagerSerialize","XFrameClient","configure","cfg","config","defaults","extend","clearConfiguration","getTargets","postMessage","targets","map","document","getElementsByTagName","i","urlHack","createElement","href","src","protocol","host","contentWindow","defaultOriginUrl","window","parent","concat","remotes","wrapForTransport","packingSlip","JSON","stringify","postal","unwrapFromTransport","msgData","indexOf","parse","ex","event","currentTarget","parsed","data","remote","find","x","onMessage","sendMessage","envelope","safeSerialize","cloneDeep","each","disconnect","clients","reduce","isArray","_memoRemoteByInstanceId","_memoRemoteByTarget","doNotNotify","_disconnectClient","without","signalReady","callback","length","def","sendPing","eventName","handler","bubble","Error","stopListeningToWorker","removeEventListener","pop","memo","proxy","tgt","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","entries","Symbol","iterator","next","done","_step$value","_slicedToArray","value","key","val","isPlainObject","err","Object","defineProperty","sliceIterator","arr","_arr","_n","_d","_e","_s","_i","Array","TypeError","regeneratorRuntime","mark","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","k","wrap","context$1$0","prev","keys","t0","finish","stop","location","test","navigator","userAgent","allowedOrigins","enabled","_classCallCheck","instance","Constructor","_inherits","subClass","superClass","prototype","create","constructor","enumerable","writable","configurable","setPrototypeOf","__proto__","_createClass","defineProperties","props","descriptor","protoProps","staticProps","_get","_x","_x2","_x3","_again","object","property","receiver","Function","desc","getOwnPropertyDescriptor","getter","get","getPrototypeOf","_postal$fedx$FederationClient","_len","args","_key","transportName","hasDomainFilters","contains","shouldProcess","context","FederationClient"],"mappings":"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","file":"postal.xframe.min.js","sourcesContent":["/*!\n *  * postal.xframe - postal.js/postal.federation plugin for federating instances of postal.js across iframe/window boundaries.\n *  * Author: Jim Cowart (http://ifandelse.com)\n *  * Version: v0.5.0\n *  * Url: http://github.com/postaljs/postal.xframe\n *  * License(s): (MIT OR GPL-2.0)\n */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"), require(\"postal\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"lodash\", \"postal\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"postalXframe\"] = factory(require(\"lodash\"), require(\"postal\"));\n\telse\n\t\troot[\"postalXframe\"] = factory(root[\"_\"], root[\"postal\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t// istanbul ignore next\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\t\n\tvar _lodash = __webpack_require__(1);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _postal = __webpack_require__(2);\n\t\n\tvar _postal2 = _interopRequireDefault(_postal);\n\t\n\tvar _utils = __webpack_require__(3);\n\t\n\tvar _state = __webpack_require__(4);\n\t\n\tvar _XFrameClient = __webpack_require__(5);\n\t\n\tvar _XFrameClient2 = _interopRequireDefault(_XFrameClient);\n\t\n\tfunction listener() {\n\t\tplugin.routeMessage.apply(plugin, arguments);\n\t}\n\t\n\tfunction listenToWorker(worker) {\n\t\tif (!_lodash2[\"default\"].include(_state.state.workers, worker)) {\n\t\t\tworker.addEventListener(\"message\", listener);\n\t\t\t_state.state.workers.push(worker);\n\t\t}\n\t}\n\t\n\t_XFrameClient2[\"default\"].getInstance = function getInstance(source, origin, instanceId) {\n\t\tvar client = new _XFrameClient2[\"default\"](source, {\n\t\t\torigin: origin,\n\t\t\tisWorker: typeof Worker !== \"undefined\" && source instanceof Worker\n\t\t}, instanceId);\n\t\tif (client.options.isWorker) {\n\t\t\tlistenToWorker(client.target);\n\t\t}\n\t\treturn client;\n\t};\n\t\n\tvar NO_OP = function NO_OP() {};\n\t\n\tvar plugin = _postal2[\"default\"].fedx.transports.xframe = {\n\t\teagerSerialize: _state.env.useEagerSerialize,\n\t\tXFrameClient: _XFrameClient2[\"default\"],\n\t\tconfigure: function configure(cfg) {\n\t\t\tif (cfg) {\n\t\t\t\t_state.state.config = _lodash2[\"default\"].defaults(_lodash2[\"default\"].extend(_state.state.config, cfg), _state.state.defaults);\n\t\t\t}\n\t\t\treturn _state.state.config;\n\t\t},\n\t\tclearConfiguration: function clearConfiguration() {\n\t\t\t_state.state.config = _lodash2[\"default\"].extend({}, _state.state.defaults);\n\t\t},\n\t\t//find all iFrames and the parent window if in an iframe\n\t\tgetTargets: _state.env.isWorker ? function () {\n\t\t\treturn [{\n\t\t\t\ttarget: {\n\t\t\t\t\tpostMessage: postMessage\n\t\t\t\t}\n\t\t\t}]; // TO-DO: look into this...\n\t\t} : function () {\n\t\t\tvar targets = _lodash2[\"default\"].map(document.getElementsByTagName(\"iframe\"), function (i) {\n\t\t\t\tvar urlHack = document.createElement(\"a\");\n\t\t\t\turlHack.href = i.src;\n\t\t\t\tvar origin = urlHack.protocol + \"//\" + urlHack.host;\n\t\t\t\t// The following condition fixes the IE issue of setting the origin while the iframe is 'empty':\n\t\t\t\t// if the iframe has no 'src' set to some meaningful url (at this very moment),\n\t\t\t\t// then the urlHack returns neither protocol nor host information.\n\t\t\t\tif (origin === \"//\") {\n\t\t\t\t\torigin = null;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\ttarget: i.contentWindow,\n\t\t\t\t\torigin: origin || _state.state.config.defaultOriginUrl\n\t\t\t\t};\n\t\t\t});\n\t\t\tif (window.parent && window.parent !== window) {\n\t\t\t\ttargets.push({\n\t\t\t\t\ttarget: window.parent,\n\t\t\t\t\torigin: \"*\"\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn targets.concat(_state.state.workers);\n\t\t},\n\t\tremotes: [],\n\t\twrapForTransport: _state.env.useEagerSerialize ? function (packingSlip) {\n\t\t\treturn JSON.stringify({\n\t\t\t\tpostal: true,\n\t\t\t\tpackingSlip: packingSlip\n\t\t\t});\n\t\t} : function (packingSlip) {\n\t\t\treturn {\n\t\t\t\tpostal: true,\n\t\t\t\tpackingSlip: packingSlip\n\t\t\t};\n\t\t},\n\t\tunwrapFromTransport: function unwrapFromTransport(msgData) {\n\t\t\tif (typeof msgData === \"string\" && (_state.env.useEagerSerialize || msgData.indexOf('\"postal\":true') !== -1)) {\n\t\t\t\ttry {\n\t\t\t\t\treturn JSON.parse(msgData);\n\t\t\t\t} catch (ex) {\n\t\t\t\t\treturn {};\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn msgData;\n\t\t\t}\n\t\t},\n\t\trouteMessage: function routeMessage(event) {\n\t\t\t// source = remote window or worker?\n\t\t\tvar source = event.source || event.currentTarget;\n\t\t\tvar parsed = this.unwrapFromTransport(event.data);\n\t\t\tif (parsed.postal) {\n\t\t\t\tvar remote = _lodash2[\"default\"].find(this.remotes, function (x) {\n\t\t\t\t\treturn x.target === source;\n\t\t\t\t});\n\t\t\t\tif (!remote) {\n\t\t\t\t\tremote = _XFrameClient2[\"default\"].getInstance(source, event.origin, parsed.packingSlip.instanceId);\n\t\t\t\t\tthis.remotes.push(remote);\n\t\t\t\t}\n\t\t\t\tremote.onMessage(parsed.packingSlip);\n\t\t\t}\n\t\t},\n\t\tsendMessage: function sendMessage(env) {\n\t\t\tvar envelope = env;\n\t\t\tif (_state.state.config.safeSerialize) {\n\t\t\t\tenvelope = (0, _utils.safeSerialize)(_lodash2[\"default\"].cloneDeep(env));\n\t\t\t}\n\t\t\t_lodash2[\"default\"].each(this.remotes, function (remote) {\n\t\t\t\tremote.sendMessage(envelope);\n\t\t\t});\n\t\t},\n\t\tdisconnect: function disconnect(options) {\n\t\t\toptions = options || {};\n\t\t\tvar clients = options.instanceId ?\n\t\t\t// an instanceId value or array was provided, let's get the client proxy instances for the id(s)\n\t\t\t_lodash2[\"default\"].reduce(_lodash2[\"default\"].isArray(options.instanceId) ? options.instanceId : [options.instanceId], _utils._memoRemoteByInstanceId, [], this) :\n\t\t\t// Ok so we don't have instanceId(s), let's try target(s)\n\t\t\toptions.target ?\n\t\t\t// Ok, so we have a targets array, we need to iterate over it and get a list of the proxy/client instances\n\t\t\t_lodash2[\"default\"].reduce(_lodash2[\"default\"].isArray(options.target) ? options.target : [options.target], _utils._memoRemoteByTarget, [], this) :\n\t\t\t// aww, heck - we don't have instanceId(s) or target(s), so it's ALL THE REMOTES\n\t\t\tthis.remotes;\n\t\t\tif (!options.doNotNotify) {\n\t\t\t\t_lodash2[\"default\"].each(clients, _utils._disconnectClient, this);\n\t\t\t}\n\t\t\tthis.remotes = _lodash2[\"default\"].without.apply(null, [this.remotes].concat(clients));\n\t\t},\n\t\tsignalReady: function signalReady(targets, callback) {\n\t\t\ttargets = _lodash2[\"default\"].isArray(targets) ? targets : [targets];\n\t\t\ttargets = targets.length ? targets : this.getTargets();\n\t\t\tcallback = callback || NO_OP;\n\t\t\t_lodash2[\"default\"].each(targets, function (def) {\n\t\t\t\tif (def.target) {\n\t\t\t\t\tdef.origin = def.origin || _state.state.config.defaultOriginUrl;\n\t\t\t\t\tvar remote = _lodash2[\"default\"].find(this.remotes, function (x) {\n\t\t\t\t\t\treturn x.target === def.target;\n\t\t\t\t\t});\n\t\t\t\t\tif (!remote) {\n\t\t\t\t\t\tremote = _XFrameClient2[\"default\"].getInstance(def.target, def.origin);\n\t\t\t\t\t\tthis.remotes.push(remote);\n\t\t\t\t\t}\n\t\t\t\t\tremote.sendPing(callback);\n\t\t\t\t}\n\t\t\t}, this);\n\t\t},\n\t\taddEventListener: _state.env.isWorker ? function () {\n\t\t\taddEventListener(\"message\", listener);\n\t\t} : function (eventName, handler, bubble) {\n\t\t\t// in normal browser context\n\t\t\tif (typeof window !== \"undefined\" && typeof window.addEventListener === \"function\") {\n\t\t\t\twindow.addEventListener(eventName, handler, bubble);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"postal.xframe only works with browsers that support window.addEventListener\");\n\t\t\t}\n\t\t},\n\t\tlistenToWorker: listenToWorker,\n\t\tstopListeningToWorker: function stopListeningToWorker(worker) {\n\t\t\tif (worker) {\n\t\t\t\tworker.removeEventListener(\"message\", listener);\n\t\t\t\t_state.state.workers = _lodash2[\"default\"].without(_state.state.workers, worker);\n\t\t\t} else {\n\t\t\t\twhile (_state.state.workers.length) {\n\t\t\t\t\t_state.state.workers.pop().removeEventListener(\"message\", listener);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\t\n\tplugin.addEventListener(\"message\", listener, false);\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t// istanbul ignore next\n\t\n\tvar _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; })();\n\t\n\texports._memoRemoteByInstanceId = _memoRemoteByInstanceId;\n\texports._memoRemoteByTarget = _memoRemoteByTarget;\n\texports._disconnectClient = _disconnectClient;\n\texports.safeSerialize = safeSerialize;\n\t// istanbul ignore next\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\t\n\tvar _lodash = __webpack_require__(1);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tfunction _memoRemoteByInstanceId(memo, instanceId) {\n\t\tvar proxy = _lodash2[\"default\"].find(this.remotes, function (x) {\n\t\t\treturn x.instanceId === instanceId;\n\t\t});\n\t\tif (proxy) {\n\t\t\tmemo.push(proxy);\n\t\t}\n\t\treturn memo;\n\t}\n\t\n\tfunction _memoRemoteByTarget(memo, tgt) {\n\t\tvar proxy = _lodash2[\"default\"].find(this.remotes, function (x) {\n\t\t\treturn x.target === tgt;\n\t\t});\n\t\tif (proxy) {\n\t\t\tmemo.push(proxy);\n\t\t}\n\t\treturn memo;\n\t}\n\t\n\tfunction _disconnectClient(client) {\n\t\tclient.disconnect();\n\t}\n\t\n\tfunction safeSerialize(envelope) {\n\t\tvar _iteratorNormalCompletion = true;\n\t\tvar _didIteratorError = false;\n\t\tvar _iteratorError = undefined;\n\t\n\t\ttry {\n\t\t\tfor (var _iterator = entries(envelope)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t\t\t\tvar _step$value = _slicedToArray(_step.value, 2);\n\t\n\t\t\t\tvar key = _step$value[0];\n\t\t\t\tvar val = _step$value[1];\n\t\n\t\t\t\tif (typeof val === \"function\") {\n\t\t\t\t\tdelete envelope[key];\n\t\t\t\t}\n\t\t\t\tif (_lodash2[\"default\"].isPlainObject(val)) {\n\t\t\t\t\tsafeSerialize(val);\n\t\t\t\t}\n\t\t\t\tif (_lodash2[\"default\"].isArray(val)) {\n\t\t\t\t\t_lodash2[\"default\"].each(val, safeSerialize);\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (err) {\n\t\t\t_didIteratorError = true;\n\t\t\t_iteratorError = err;\n\t\t} finally {\n\t\t\ttry {\n\t\t\t\tif (!_iteratorNormalCompletion && _iterator[\"return\"]) {\n\t\t\t\t\t_iterator[\"return\"]();\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tif (_didIteratorError) {\n\t\t\t\t\tthrow _iteratorError;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\treturn envelope;\n\t}\n\t\n\tvar entries = regeneratorRuntime.mark(function entries(obj) {\n\t\tvar _iteratorNormalCompletion2, _didIteratorError2, _iteratorError2, _iterator2, _step2, k;\n\t\n\t\treturn regeneratorRuntime.wrap(function entries$(context$1$0) {\n\t\t\twhile (1) switch (context$1$0.prev = context$1$0.next) {\n\t\t\t\tcase 0:\n\t\t\t\t\tif ([\"object\", \"function\"].indexOf(typeof obj) === -1) {\n\t\t\t\t\t\tobj = {};\n\t\t\t\t\t}\n\t\t\t\t\t_iteratorNormalCompletion2 = true;\n\t\t\t\t\t_didIteratorError2 = false;\n\t\t\t\t\t_iteratorError2 = undefined;\n\t\t\t\t\tcontext$1$0.prev = 4;\n\t\t\t\t\t_iterator2 = Object.keys(obj)[Symbol.iterator]();\n\t\n\t\t\t\tcase 6:\n\t\t\t\t\tif (_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done) {\n\t\t\t\t\t\tcontext$1$0.next = 13;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tk = _step2.value;\n\t\t\t\t\tcontext$1$0.next = 10;\n\t\t\t\t\treturn [k, obj[k]];\n\t\n\t\t\t\tcase 10:\n\t\t\t\t\t_iteratorNormalCompletion2 = true;\n\t\t\t\t\tcontext$1$0.next = 6;\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase 13:\n\t\t\t\t\tcontext$1$0.next = 19;\n\t\t\t\t\tbreak;\n\t\n\t\t\t\tcase 15:\n\t\t\t\t\tcontext$1$0.prev = 15;\n\t\t\t\t\tcontext$1$0.t0 = context$1$0[\"catch\"](4);\n\t\t\t\t\t_didIteratorError2 = true;\n\t\t\t\t\t_iteratorError2 = context$1$0.t0;\n\t\n\t\t\t\tcase 19:\n\t\t\t\t\tcontext$1$0.prev = 19;\n\t\t\t\t\tcontext$1$0.prev = 20;\n\t\n\t\t\t\t\tif (!_iteratorNormalCompletion2 && _iterator2[\"return\"]) {\n\t\t\t\t\t\t_iterator2[\"return\"]();\n\t\t\t\t\t}\n\t\n\t\t\t\tcase 22:\n\t\t\t\t\tcontext$1$0.prev = 22;\n\t\n\t\t\t\t\tif (!_didIteratorError2) {\n\t\t\t\t\t\tcontext$1$0.next = 25;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tthrow _iteratorError2;\n\t\n\t\t\t\tcase 25:\n\t\t\t\t\treturn context$1$0.finish(22);\n\t\n\t\t\t\tcase 26:\n\t\t\t\t\treturn context$1$0.finish(19);\n\t\n\t\t\t\tcase 27:\n\t\t\t\tcase \"end\":\n\t\t\t\t\treturn context$1$0.stop();\n\t\t\t}\n\t\t}, entries, this, [[4, 15, 19, 27], [20,, 22, 26]]);\n\t});\n\texports.entries = entries;\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t// istanbul ignore next\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\t\n\tvar _lodash = __webpack_require__(1);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar env = {\n\t\torigin: location.origin || location.protocol + \"//\" + location.host,\n\t\tisWorker: typeof window === \"undefined\" && postMessage && location,\n\t\t// I know, I KNOW. The alternative was very expensive perf & time-wise\n\t\t// so I saved you a perf hit by checking the stinking UA. Sigh.\n\t\t// I sought the opinion of several other devs. We all traveled\n\t\t// to the far east to consult with the wisdom of a monk - turns\n\t\t// out he didn\"t know JavaScript, and our passports were stolen on the\n\t\t// return trip. We stowed away aboard a freighter headed back to the\n\t\t// US and by the time we got back, no one had heard of IE 8 or 9. True story.\n\t\tuseEagerSerialize: /MSIE [8,9]/.test(navigator.userAgent)\n\t};\n\t\n\texports.env = env;\n\tvar defaults = {\n\t\tallowedOrigins: [env.origin],\n\t\tenabled: true,\n\t\tdefaultOriginUrl: \"*\",\n\t\tsafeSerialize: false\n\t};\n\t\n\tvar state = {\n\t\tworkers: [],\n\t\tconfig: _lodash2[\"default\"].extend({}, defaults),\n\t\tdefaults: defaults\n\t};\n\texports.state = state;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t// istanbul ignore next\n\t\n\tvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\t\n\t// istanbul ignore next\n\t\n\tvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; desc = parent = undefined; continue _function; } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\t\n\t// istanbul ignore next\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\t\n\t// istanbul ignore next\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t// istanbul ignore next\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar _postal = __webpack_require__(2);\n\t\n\tvar _postal2 = _interopRequireDefault(_postal);\n\t\n\tvar _lodash = __webpack_require__(1);\n\t\n\tvar _lodash2 = _interopRequireDefault(_lodash);\n\t\n\tvar _state = __webpack_require__(4);\n\t\n\tvar XFrameClient = (function (_postal$fedx$FederationClient) {\n\t\t_inherits(XFrameClient, _postal$fedx$FederationClient);\n\t\n\t\tfunction XFrameClient() {\n\t\t\t_classCallCheck(this, XFrameClient);\n\t\n\t\t\tfor (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t\t\t\targs[_key] = arguments[_key];\n\t\t\t}\n\t\n\t\t\t_get(Object.getPrototypeOf(XFrameClient.prototype), \"constructor\", this).apply(this, args);\n\t\t\tthis.transportName = \"xframe\";\n\t\t}\n\t\n\t\t_createClass(XFrameClient, [{\n\t\t\tkey: \"shouldProcess\",\n\t\t\tvalue: function shouldProcess() {\n\t\t\t\tvar hasDomainFilters = !!_state.state.config.allowedOrigins.length;\n\t\t\t\treturn _state.state.config.enabled && (\n\t\t\t\t// another frame/window\n\t\t\t\tthis.options.origin === \"*\" || hasDomainFilters && _lodash2[\"default\"].contains(_state.state.config.allowedOrigins, this.options.origin) || !hasDomainFilters ||\n\t\t\t\t// worker\n\t\t\t\tthis.options.isWorker && _lodash2[\"default\"].contains(_state.state.workers, this.target) ||\n\t\t\t\t// we are in a worker\n\t\t\t\t_state.env.isWorker);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: \"send\",\n\t\t\tvalue: function send(packingSlip) {\n\t\t\t\tif (this.shouldProcess()) {\n\t\t\t\t\tvar context = _state.env.isWorker ? null : this.target;\n\t\t\t\t\tvar args = [_postal2[\"default\"].fedx.transports.xframe.wrapForTransport(packingSlip)];\n\t\t\t\t\tif (!this.options.isWorker && !_state.env.isWorker) {\n\t\t\t\t\t\targs.push(this.options.origin);\n\t\t\t\t\t}\n\t\t\t\t\tif (!_state.env.isWorker) {\n\t\t\t\t\t\tif (args.length === 1) {\n\t\t\t\t\t\t\tthis.target.postMessage(args[0]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.target.postMessage(args[0], args[1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.target.postMessage.apply(context, args);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn XFrameClient;\n\t})(_postal2[\"default\"].fedx.FederationClient);\n\t\n\texports[\"default\"] = XFrameClient;\n\tmodule.exports = exports[\"default\"];\n\n/***/ })\n/******/ ])\n});\n;"]}